function loadScript(e,t){function s(){i||(i=!0,t(e,"ok"))}function n(){var e;i||(e=a.readyState,"complete"===e&&s())}function l(){i||(i=!0,t(e,"error"))}var i=!1,a=document.createElement("script");return a.onload=s,a.onreadystatechange=n,a.onerror=l,a.src=e,document.body.appendChild(a),a}function playSound(e){""!=e&&(void 0!=audioTap&&void 0!=audioTap[0]&&audioTap[0].pause(),audioTap=$('<audio id="audioDemo" controls preload="auto"><source src="../theme_HIS/sounds/'+e+'.mp3" type="audio/mp3"><source src="../theme_HIS/sounds/'+e+'.ogg" type="audio/ogg"></audio>'),audioTap[0].play())}function verticalHeight(){var e=(parseInt($("body").height())-$(".screen").height())/2;e<0&&(e=0),$(".screen").css("margin-top",e+"px")}function init(){verticalHeight(),setTimeout(function(){$(".menu_nav").removeClass("in").addClass("out")},1200),$(this).width()<992&&$(".reload_btn").removeClass("center_icon"),$(".submenu_control").click(function(){$(".menu_nav").toggleClass("out in ")}),$(".full_screen").click(function(){$.fullscreen.isFullScreen()?(verticalHeight(),$.fullscreen.exit()):($("body").fullscreen().css({"background-color":"#81745E"}),verticalHeight()),$(this).children().children().toggleClass("fa-expand fa-compress")}),$(window).resize(function(){$(this).width()<992?($(".real_body").parent().removeClass("container ").addClass("container-fluid"),$(".reload_btn").removeClass("center_icon")):$(".reload_btn").addClass("center_icon"),verticalHeight()}),$(".reload_btn").click(function(){loadContent(slide_src[curSlide-1])}),"undefined"!=typeof lessonData&&(lessonCode=$.trim(lessonData.code_name),slide_src.push($.trim(lessonData.main.src)),lessonTitles.push($.trim(lessonData.main.title)),slide_src.push($.trim(lessonData.intro.src)),lessonTitles.push($.trim(lessonData.intro.title)),slide_src.push($.trim(lessonData.objective.src)),lessonTitles.push($.trim(lessonData.objective.title)),$.each(lessonData.learning,function(e,t){slide_src.push($.trim(t.src)),lessonTitles.push($.trim(t.title))}),slide_src.push($.trim(lessonData.quiz.src)),lessonTitles.push($.trim(lessonData.quiz.title)),""!==$.trim(lessonData.glossary.src)?(slide_src.push($.trim(lessonData.glossary.src)),lessonTitles.push($.trim(lessonData.glossary.title))):$("#content_menu li.glossary").addClass("dimmed"),slide_src.push($.trim(lessonData.summary.src)),lessonTitles.push($.trim(lessonData.summary.title))),loadTitles(),loadContent(slide_src[0]),$(".numbering .last").text(slide_src.length),$(".next_nav").click(function(){curSlide<slide_src.length&&(++curSlide,loadContent(slide_src[curSlide-1]))}),$(".prev_nav").click(function(){curSlide>1&&(--curSlide,loadContent(slide_src[curSlide-1]))}),loadControls(),$("#content_menu li").click(function(){$(this).hasClass("dimmed")||($(".menu_nav").toggleClass("out in "),activeMenu($(this)))})}function loadTitles(){$(".all_lessons").empty(),$.each(lessonTitles,function(e,t){$('<li><a href="#" title="'+t+'">'+t+"</a></li>").appendTo(".all_lessons").click(function(){curSlide=$(this).index()+1,loadContent(slide_src[curSlide-1])})}),$(".all_lessons li").first().addClass("current")}function loadControls(){$("#note").click(function(){$("#note_modal #add_note").val("").attr("style","")}),loadNote(),$(".search_btn").click(function(){$(".search_inbux").val(""),$(".search_result ul").empty()})}function activeMenu(e){var t=e.index()+1;e.addClass("active").siblings().removeClass("active"),1==t?(curSlide=t,loadContent(slide_src[curSlide-1])):2==t?(curSlide=t+2,loadContent(slide_src[curSlide-1])):3==t?(curSlide=slide_src.length-2,$("#content_menu li.glossary").hasClass("dimmed")&&++curSlide,loadContent(slide_src[curSlide-1])):(curSlide=slide_src.length-(5-t),loadContent(slide_src[curSlide-1]))}function loadContent(e){2==curSlide||3==curSlide?playSound(allSounds[curSlide-2]):curSlide>slide_src.length-3?playSound(allSounds[allSounds.length-(slide_src.length-curSlide)-1]):void 0!=audioTap&&void 0!=audioTap[0]&&audioTap[0].pause();var t=checkExtension(e);if("img"==t)$(".content").html(' <img width="100%" height="100%" src="'+currFileName()+"/"+e+'" />');else if("video"==t){var s=e.split(".")[0];$(".content").html(' <video width="100%" height="100%" controls poster="'+currFileName()+"/"+s+'.png">   <source src="'+currFileName()+"/"+s+'.mp4" type="video/mp4">   <source src="'+currFileName()+"/"+s+'.ogg" type="video/ogg"> Your browser does not support the video tag. </video>')}else"html"==t&&$(".content").html('<object data="'+currFileName()+"/"+e+'"></object>');$(".numbering .current").text(curSlide);var n=curSlide;n=1==curSlide||2==curSlide||3==curSlide?1:curSlide==slide_src.length-1&&$("#content_menu li.glossary").hasClass("dimmed")||curSlide==slide_src.length-2&&!$("#content_menu li.glossary").hasClass("dimmed")?3:curSlide!=slide_src.length-1||$("#content_menu li.glossary").hasClass("dimmed")?curSlide==slide_src.length?5:2:4,$("#content_menu li:nth-child("+n+")").addClass("active").siblings().removeClass("active"),$(".all_lessons li").eq(curSlide-1).addClass("current").siblings().removeClass("current"),$(".lesson_name .curr_lesson").text($(".all_lessons li.current").text())}function checkExtension(e){var t=e.substr(e.lastIndexOf(".")+1);switch(t){case"jpg":case"png":case"gif":return"img";case"mp4":case"mp3":case"ogg":return"video";case"html":return"html"}}function loadNote(){$("#note_modal .results").empty(),getNotes(),$("#add_note").on("input",function(){""!=$.trim($(this).val())?$(this).next("#add_btn").removeClass("dimmed"):$(this).next("#add_btn").addClass("dimmed")}),$("#add_btn").click(function(){""!=$("#add_note").val()&&(localStorage.get("notes",function(e){"undefined"==typeof e[lessonCode]&&(e[lessonCode]=[]),e[lessonCode].push({page:curSlide,text:$("#add_note").val().replace(/\n/g,"<br/>")}),localStorage.setItem("notes",JSON.stringify(e)),getNotes()},function(){var e={};e[lessonCode]=[{page:curSlide,text:$("#add_note").val().replace(/\n/g,"<br/>")}],localStorage.setItem("notes",JSON.stringify(e)),getNotes()}),$("#add_note").val(""))})}function getNotes(){$("#note_modal .results").empty(),localStorage.get("notes",function(e){"undefined"!=typeof e[lessonCode]&&$.each(e[lessonCode],function(e,t){$('<div class="item"><div class="desc" contenteditable="false">'+t.text+'</div><div class="options"  ><a title="حذف الملاحظة" class="delete_item"><i class="fa fa-trash-o "></i></a><a title="تعديل الملاحظة" class="edit_item"><i class="fa fa-pencil-square-o "></i></a></div><div class="clearfix"></div></div>').appendTo("#note_modal .results").find(".options .delete_item").click(function(){var e=$(this);localStorage.get("notes",function(t){t[lessonCode].splice(parseInt(e.parent().parent().index()),1),localStorage.setItem("notes",JSON.stringify(t))}),$(this).parent().parent().remove()}).next(".edit_item").click(function(){var e=$(this);$(this).parent().parent().toggleClass("save"),e.children("i").toggleClass("fa-floppy-o fa-pencil-square-o ");var t=e.parent().parent().children(".desc");"true"==t.attr("contenteditable")?(t.attr("contenteditable",!1),localStorage.get("notes",function(s){s[lessonCode][parseInt(e.parent().parent().index())].text=t.html(),localStorage.setItem("notes",JSON.stringify(s))})):t.attr("contenteditable",!0)})})})}var slide_src=[],curSlide=1,lessonTitles=[],lessonCode,audioTap,allSounds=["Intro","Goals","Quiz","Dictionary","Summery"],currFileName=function(){var e=location.href.split("/").slice(-1)[0];return e.substring(0,e.length-5)};Storage.prototype.get=function(e,t,s){if("undefined"!=typeof Storage){var n=localStorage.getItem(e);n?t(JSON.parse(n)):"function"==typeof s&&s()}else alert("Sorry, your browser does not support Web Storage...")},$(function(){loadScript(currFileName()+"/lesson_key.json",function(e,t){}).onload=function(){function e(){if(n="False",$(".search_result ul").html(""),""!=$(".search_inbux").val()){for(var e=0;e<lessonData.learning.length;e++)l[e]="False";s=$(".search_inbux").val();for(var a=0;a<lessonData.learning.length;a++){i=lessonData.learning[a].keywords;for(var o=0;o<i.length;o++)i.substr(o,s.length)==s?"True"!=l[a]&&(l[a]="True"):"True"!=l[a]&&(l[a]="False")}for(var a=0;a<l.length;a++)"True"==l[a]&&(t(a),n="True");"False"==n&&$(".search_result ul").append('<li class="not_fount">لا يوجد نتائج بحث</li>')}$(".search_result ul .clickable_item").click(function(){curSlide=$(this).attr("id").substring(4,$(this).attr("id").length),curSlide=parseInt(curSlide)+3,loadContent(slide_src[curSlide-1])})}function t(e){i=lessonData.learning[e].keywords;for(var t=0;t<s.length;t++){a="";for(var n=0;n<i.length;n++)i.substr(n,s.length)==s?(a+='<span class="key_words">'+i.substr(n,s.length)+"</span>",n+=s.length-1):a+=i.slice(n,n+1);i=a;break}$(".search_result ul").append('<li id="item'+parseInt(e+1)+'" class="clickable_item">شريحة '+parseInt(e+1)+": "+lessonData.learning[e].title+'<br><span class="lesson_words">'+a+"</span></li>")}init();var s,n,l=new Array;$(".search_button").click(function(){e()}),$(".search_inbux").keydown(function(t){13==t.keyCode&&e()});var i,a}});